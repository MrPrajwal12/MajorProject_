<!DOCTYPE html>
<html>

<head>
  <title>Diet Plan Generator</title>
  <link rel="icon" type="image/x-icon" href="./img/ai.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <script type="module" src="https://unpkg.com/ionicons@6.0.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@6.0.0/dist/ionicons/ionicons.js"></script>
  <style>
    /* 1st change */
    @import url("https://fonts.googleapis.com/css2?family=Poppins&display=swap");

    :root {
      /**
* colors
*/

      --st-patricks-blue: hsl(236, 57%, 28%);
      --amaranth-purple: hsl(335, 88%, 38%);
      --royal-blue-dark: hsl(231, 68%, 21%);
      --chrome-yellow: hsl(39, 100%, 52%);
      --space-cadet-1: hsl(230, 41%, 25%);
      --space-cadet-2: hsl(230, 59%, 16%);
      --winter-sky_50: hsla(335, 87%, 53%, 0.5);
      --purple-navy: hsl(236, 26%, 43%);
      --ksu-purple: hsl(275, 54%, 33%);
      --winter-sky: hsl(335, 87%, 53%);
      --razzmatazz: hsl(335, 87%, 51%);
      --platinum: hsl(0, 0%, 90%);
      --black_70: hsla(0, 0%, 0%, 0.7);
      --rajah: hsl(29, 99%, 67%);
      --white: hsl(0, 0%, 100%);
      --color: var(--white);
      --gradient-1: linear-gradient(90deg,
          var(--royal-blue-dark) 0,
          var(--ksu-purple) 51%,
          var(--royal-blue-dark));
      --gradient-2: linear-gradient(90deg, var(--razzmatazz), var(--rajah));

      /**
* typography
*/

      --ff-source-sans-pro: "Source Sans Pro", sans-serif;
      --ff-poppins: "Poppins", sans-serif;

      --fs-1: 4.2rem;
      --fs-2: 3.8rem;
      --fs-3: 3.2rem;
      --fs-4: 2.5rem;
      --fs-5: 2.4rem;
      --fs-6: 2rem;
      --fs-7: 1.8rem;
      --fs-8: 1.5rem;

      --fw-500: 500;
      --fw-600: 600;
      --fw-700: 700;

      /**
* border radius
*/

      --radius-4: 4px;
      --radius-12: 12px;

      /**
* spacing
*/

      --section-padding: 60px;

      /**
* transition
*/

      --transition-1: 0.15s ease;
      --transition-2: 0.35s ease;
      --cubic-in: cubic-bezier(0.51, 0.03, 0.64, 0.28);
      --cubic-out: cubic-bezier(0.33, 0.85, 0.56, 1.02);

      /**
* shadow
*/

      --shadow: 0 5px 20px 1px hsla(220, 63%, 33%, 0.1);
    }

    body {
      font-family: "Open Sans", sans-serif;
      color: #fff;
    }

    .hero {
      padding-top: 10%;
      background-image: linear-gradient(90deg,
          hsl(231, 68%, 21%) 0,
          hsl(275, 54%, 33%) 51%,
          hsl(231, 68%, 21%));
    }

    .table {
      color: #fff;
    }

    a,
    img,
    span,
    input,
    button,
    ion-icon {
      display: block;
    }

    li {
      list-style: none;
    }

    li a {
      text-decoration: none;
    }

    li a:hover {
      color: white;
      text-shadow: 2px 2px #556270;
      text-decoration: none;
    }

    button,
    input {
      background: none;
      border: none;
      font: inherit;
    }

    a {
      text-decoration: none;
      color: #d9232d;
    }

    a:hover {
      color: #e24d55;
      text-decoration: none;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-family: "Raleway", sans-serif;
      color: #fff;
      font-size: larger;
    }

    /*--------------------------------------------------------------
  # Back to top button
  --------------------------------------------------------------*/
    .back-to-top {
      position: fixed;
      visibility: hidden;
      opacity: 0;
      right: 15px;
      bottom: 15px;
      z-index: 996;
      background: #d9232d;
      width: 40px;
      height: 40px;
      border-radius: 4px;
      transition: all 0.4s;
    }

    .back-to-top i {
      font-size: 28px;
      color: #fff;
      line-height: 0;
    }

    .back-to-top:hover {
      background: #e1444d;
      color: #fff;
    }

    .back-to-top.active {
      visibility: visible;
      opacity: 1;
    }

    /*--------------------------------------------------------------
  # Header
  --------------------------------------------------------------*/
    .header {
      --color: var(--white);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      padding-block: 14px;
      z-index: 4;
      transition: var(--transition-1);
    }

    .header.active {
      --color: var(--st-patricks-blue);
      position: fixed;
      background-color: var(--white);
      box-shadow: 0 2px 30px hsla(0, 0%, 0%, 0.1);
    }

    .logo {
      color: white;
      font-size: 30px;
      margin: 0;
      padding: 0;
      line-height: 1;
      font-weight: 700;
      text-transform: uppercase;
    }

    .logo a:hover {
      text-decoration: none;
    }

    .header .logo a {
      color: white;
      text-decoration: none;
    }

    .header .logo a:hover {
      text-shadow: 2px 2px#556270;
    }

    .header .logo img {
      max-height: 40px;
      filter: invert(1);

    }

    .header .btn {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-inline-start: auto;
    }

    .header .btn {
      margin-inline-start: 0;
    }

    .header .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 30px;
      height: 60px;
    }

    /* 1st change ends here */
    .header .container {
      justify-content: end;
      padding: 0;
      width: 100%;

    }

    .navbar {
      top: 0;
      left: -280px;
      width: 100%;
      height: 500px;
      max-width: 280px;
      min-height: 100%;
      padding: 20px;
      visibility: hidden;
      z-index: 2;
      transition: 0.25s var(--cubic-in);
    }

    .navbar.active {
      transform: translateX(280px);
      visibility: visible;
      transition: 0.5s var(--cubic-out);
      background-color: var(--white);
      position: fixed;
      display: inline;
    }

    .navbar-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-block: 10px 30px;
      margin-left: 30px;
    }

    .navbar-top .logo {
      color: var(--st-patricks-blue);
      font-size: 2.2rem;
      font-weight: var(--fw-700);
    }

    .navbar-top .logo a {
      text-decoration: none;
    }

    .nav-close-btn {
      color: var(--space-cadet-1);
      font-size: 2.8rem;
      padding: 4px;
      background: none;
      border: none;
    }

    .navbar-item:not(:last-child) {
      border-bottom: 1px solid var(--platinum);
    }

    .navbar-item li a:hover {
      text-decoration: none;

    }

    .navbar-link {
      color: var(--space-cadet-1);
      font-size: var(--fs-8);
      font-weight: var(--fw-600);
      padding-block: 12px;
    }

    .overlay {
      position: fixed;
      inset: 0;
      background-color: var(--black_70);
      z-index: 1;
      opacity: 0;
      pointer-events: none;
      transition: var(--transition-2);
    }

    .overlay.active {
      opacity: 1;
      pointer-events: all;
    }


    @media (min-width: 768px) {
      /**
* REUSED STYLE
*/

      .header .container {
        max-width: 720px;
      }
    }

    @media (max-width: 1366px) {
      /* .header .container{
    max-width: 1069px;
  } */
    }

    /* Second Change */
    /**
  * Mobile Navigation 
  */

    .nav-open-btn {
      color: var(--color);
      font-size: 32px;
      padding: 4px;
      background: none;
      border: none;
    }

    @media (min-width: 992px) {
      /**
* CUSTOM PROPERTY
*/

      :root {
        /**
 * typography
 */

        --fs-1: 5.4rem;
      }

      /**
* REUSED STYLE
*/

      .header .container {
        max-width: 1069px;
      }

      /**
* HEADER
*/

      .header {
        padding-block: 20px;
      }

      .overlay,
      .nav-open-btn,
      .navbar-top {
        display: none;
      }

      .navbar,
      .navbar.active {
        all: unset;
        margin-inline-start: auto;
      }

      .header .btn {
        margin-inline-start: 0;
      }

      .navbar-list {
        display: flex;
        gap: 25px;
      }

      .navbar-item:not(:last-child) {
        border-bottom: none;
      }

      .navbar-link {
        color: var(--color);
        font-size: 20px;
      }
    }

    .header .btn {
      background-image: var(--gradient-2);
      background-size: 100%;
      color: var(--white);
      padding: 2px 20px;
      font-size: 20px;
      font-weight: var(--fw-500);
      border-radius: 0 25px;
      transition: var(--transition-2);
    }

    .header .btn:hover {
      background-position: right;
      color: var(--white);
      text-decoration: none;
      text-shadow: 2px 2px#556270;
    }

    .w-100 {
      width: 100%;
    }

    .banner-animation {
      animation: waveAnim 2s linear infinite alternate;
    }

    .center {
      text-align: center;
      /* border: 3px solid green; */

    }


    /* Second change ends here */
    /* Popup overlay is default */
    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
      background-color: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0px 0px 5px gray;
    }

    .popup-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
/* General Body Styling */

/* Reset some default styling */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
body {
  font-family: "Open Sans", sans-serif;
  color: #333333;
  background-color: #f8f9fa;
  padding: 20px;
  margin: 0;
}

/* Heading Styling */
h2,
h3 {
  font-size: 1.5rem; /* Reduce font size */
  font-weight: bold;
  color: #343a40;
  text-align: center;
  margin-bottom: 15px;
}

/* Container Section Styling */
.container-sec {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  gap: 15px; /* Reduce gap between sections */
  width: 100%;
  padding: 20px; /* Reduce padding */
  height: auto; /* Adjust for dynamic height */
}

.container-sec > section {
  flex: 1;
  padding: 15px; /* Reduce padding */
  background-color: #e9ecef;
  border-radius: 8px; /* Slightly smaller corners */
  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1); /* Subtle shadow */
  height: auto; /* Adjust height to content */
  overflow: auto;
  border: 1px solid #fff; /* Light white border */
}

/* Form Styling */
form {
  background-color: #e9ecef;
  color: #333;
}

.form-group {
  margin-bottom: 10px; /* Reduce spacing */
}

.form-group label {
  font-weight: 500;
  color: #333;
  font-size: 0.9rem; /* Smaller font size */
}

.form-group input,
.form-group select {
  width: 100%;
  padding: 5px; /* Reduce padding */
  margin-top: 3px; /* Tighten margin */
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.9rem; /* Smaller input font size */
}

.form-group .btn-primary {
  background-color: #007bff;
  border-color: #007bff;
  font-size: 0.9rem; /* Smaller button text */
  padding: 8px 16px; /* Smaller button padding */
  width: 100%;
  border-radius: 4px;
}

.form-group .btn-primary:hover {
  background-color: #0056b3;
  border-color: #0056b3;
}

/* Results Section Styling */
#personal-info-results,
#results {
  background-color: #ffffff;
  padding: 15px; /* Reduce padding */
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  margin-top: 20px; /* Reduce margin */
  font-size: 0.9rem; /* Smaller font size */
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
  overflow: hidden; /* Contain content */
  border: 1px solid #fff; /* Light white border */
}

/* Diet Plan Styling */
.diet-plan {
  background-color: #ffffff;
  padding: 15px; /* Reduce padding */
  border-radius: 8px;
  margin-top: 20px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  border: 1px solid #fff; /* Light white border */
}

.diet-plan h3 {
  font-size: 1.2rem; /* Smaller font size */
  color: #e76f51;
  margin-bottom: 10px; /* Reduce margin */
}

.diet-plan p {
  font-size: 0.9rem; /* Smaller font size */
  margin-bottom: 6px; /* Tighten spacing */
}

/* Table Styling */
.table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px; /* Reduce margin */
}

.table th,
.table td {
  padding: 8px; /* Reduce padding */
  text-align: left;
  border-bottom: 1px solid #E5E5E5;
  font-size: 0.9rem; /* Smaller font size */
}

.table th {
  background-color: #F0F8FF;
  color: #4A5568;
}

.table td {
  background-color: #ffffff;
  color: #333;
}

.table-striped tbody tr:nth-child(odd) {
  background-color: #fafafa;
}

.table-striped tbody tr:nth-child(even) {
  background-color: #f0f8ff;
}

button {
  background-color: #4A90E2;
  color: #ffffff;
  border: none;
  padding: 8px 18px; /* Smaller padding */
  font-size: 0.9rem; /* Smaller font size */
  border-radius: 8px;
  margin-top: 20px; /* Reduce margin */
}

.side-heading {
  font-weight: bold;
  color: #e76f51; /* Choose your desired color */
}
/* Modal Styles */
.modal {
      display: none; /* Hidden by default */
      position: fixed;
      z-index: 1; /* Sit on top */
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.4); /* Black with opacity */
    }

    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 400px;
      text-align: center;
    }

    .close-btn {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close-btn:hover,
    .close-btn:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    /* Style for warning label */
    .warning-label {
      color: orange;
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
    }

    .error-message {
      color: red;
      font-weight: bold;
    }

    .warning-message {
      color: #ffcc00;
    }
  </style>
  <script>
    (function (factory) {
      typeof define === "function" && define.amd
        ? define(factory)
        : factory();
    })(function () {
      "use strict";

      /**
       * The code was extracted from:
       * https://github.com/davidchambers/Base64.js
       */

      var chars =
        "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";

      function InvalidCharacterError(message) {
        this.message = message;
      }

      InvalidCharacterError.prototype = new Error();
      InvalidCharacterError.prototype.name = "InvalidCharacterError";

      function polyfill(input) {
        var str = String(input).replace(/=+$/, "");
        if (str.length % 4 == 1) {
          throw new InvalidCharacterError(
            "'atob' failed: The string to be decoded is not correctly encoded."
          );
        }
        for (
          // initialize result and counters
          var bc = 0, bs, buffer, idx = 0, output = "";
          // get next character
          (buffer = str.charAt(idx++));
          // character found in table? initialize bit storage and add its ascii value;
          ~buffer &&
            ((bs = bc % 4 ? bs * 64 + buffer : buffer),
              // and if not first of each 4 characters,
              // convert the first 8 bits to one ascii character
              bc++ % 4)
            ? (output += String.fromCharCode(255 & (bs >> ((-2 * bc) & 6))))
            : 0
        ) {
          // try to find character in table (0-63, not found => -1)
          buffer = chars.indexOf(buffer);
        }
        return output;
      }

      var atob =
        (typeof window !== "undefined" &&
          window.atob &&
          window.atob.bind(window)) ||
        polyfill;

      function b64DecodeUnicode(str) {
        return decodeURIComponent(
          atob(str).replace(/(.)/g, function (m, p) {
            var code = p.charCodeAt(0).toString(16).toUpperCase();
            if (code.length < 2) {
              code = "0" + code;
            }
            return "%" + code;
          })
        );
      }

      function base64_url_decode(str) {
        var output = str.replace(/-/g, "+").replace(/_/g, "/");
        switch (output.length % 4) {
          case 0:
            break;
          case 2:
            output += "==";
            break;
          case 3:
            output += "=";
            break;
          default:
            throw new Error("base64 string is not of the correct length");
        }

        try {
          return b64DecodeUnicode(output);
        } catch (err) {
          return atob(output);
        }
      }

      function InvalidTokenError(message) {
        this.message = message;
      }

      InvalidTokenError.prototype = new Error();
      InvalidTokenError.prototype.name = "InvalidTokenError";

      function jwtDecode(token, options) {
        if (typeof token !== "string") {
          throw new InvalidTokenError(
            "Invalid token specified: must be a string"
          );
        }

        options = options || {};
        var pos = options.header === true ? 0 : 1;

        var part = token.split(".")[pos];
        if (typeof part !== "string") {
          throw new InvalidTokenError(
            "Invalid token specified: missing part #" + (pos + 1)
          );
        }

        try {
          var decoded = base64_url_decode(part);
        } catch (e) {
          throw new InvalidTokenError(
            "Invalid token specified: invalid base64 for part #" +
            (pos + 1) +
            " (" +
            e.message +
            ")"
          );
        }

        try {
          return JSON.parse(decoded);
        } catch (e) {
          throw new InvalidTokenError(
            "Invalid token specified: invalid json for part #" +
            (pos + 1) +
            " (" +
            e.message +
            ")"
          );
        }
      }

      /*
       * Expose the function on the window object
       */

      //use amd or just through the window object.
      if (window) {
        if (typeof window.define == "function" && window.define.amd) {
          window.define("jwt_decode", function () {
            return jwtDecode;
          });
        } else if (window) {
          window.jwt_decode = jwtDecode;
        }
      }
    });
    //# sourceMappingURL=jwt-decode.js.map
  </script>
  <script>
    // Retrieve the token from local storage
    const token = localStorage.getItem("token");
    // Check if the user is authenticated
    fetch("http://localhost:5000/api/auth", {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        "x-auth-token": token,
      },
    })
      .then((response) => {
        console.log(response);
        if (response.ok) {
          // User is authenticated, proceed with the dashboard content
          console.log("User is authenticated");

          // Verify the token
          try {
            const decodedToken = jwt_decode(token);
            // The decodedToken variable now contains the decoded token payload

            // Perform any necessary checks or validations on the decoded token
            // For example, you can check the expiration date, user ID, or any other relevant information

            // If the token is valid and meets your criteria, allow access to the dashboard
            // Otherwise, redirect the user to the login page or display an error message
            console.log("Token verification successful:", decodedToken);
          } catch (error) {
            // Error occurred while decoding or verifying the token
            // Redirect the user to the login page or display an error message
            console.error("Token verification failed:", error);
            window.location.href = "http://localhost:8080/login.html";
          }

          // Here you can add your specific dashboard content and functionality
        } else {
          // User is not authenticated, redirect to the login page or handle accordingly
          console.log("User is not authenticated");
          window.location.href = "http://localhost:8080/login.html";
        }
      })
      .catch((error) => {
        console.error("Error checking authentication:", error);
        // Handle error if necessary
      });
  </script>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
</head>

<body style="height: 100%" class="hero">
  <header class="header" data-header>
    <div class="container">
      <div class="overlay" data-overlay></div>
      <h1 class="logo me-auto"><a href="index.html">Zen&Gen</a></h1>

      <a href="index.html" class="logo me-auto">
        <img src="\img\yoga.svg" alt="" />
      </a>

      <nav class="navbar" data-navbar>
        <div class="navbar-top">
          <a href="#" class="logo">ZEN&GEN</a>

          <button class="nav-close-btn" aria-label="Close Menu" data-nav-close-btn>
            <ion-icon name="close-outline"></ion-icon>
          </button>
        </div>

        <ul class="navbar-list">
          <li class="navbar-item"><a href="dashboard.html" class="navbar-link" data-navbar-link>Exercises</a></li>
          <li class="navbar-item"><a href="user_activity.html" class="navbar-link" data-navbar-link> Activities</a></li>
          <li class="navbar-item"><a href="bmi.html" class="navbar-link" data-navbar-link>Diet Plan Generator</a></li>
          <li class="navbar-item"><a href="user_activity_graph.html" class="navbar-link" data-navbar-link> Activity
              Graphs</a></li>
          <!-- <button id="logoutButton" class="logout-button">Logout</button> -->

        </ul>

        <!-- <i class="bi bi-list mobile-nav-toggle"></i> -->

      </nav>
      <button id="logoutButton" class="btn">
        <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>

        <span>Logout</span>
      </button>
      <button class="nav-open-btn" aria-label="Open Menu" data-nav-open-btn>
        <ion-icon name="menu-outline"></ion-icon>
      </button>
    </div>
  </header>
  <div id="errorModal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <p id="warningLabel" class="warning-label" style="display:none;">Warning</p> <!-- Hidden by default -->
      <p id="modalMessage"></p>
    </div>
  </div>


    <div class="container-sec">

      <section id="personal-info-section">
        <h2>Enter Personal Information for BMI and BMR Calculation</h2>
  
        <form id="personal-info-form">
          <div class="form-group">
            <label for="age">Age:</label>
            <input type="number" id="age" name="age" required />
          </div>
  
          <div class="form-group">
            <label for="weight">Weight (kg):</label>
            <input type="number" id="weight" name="weight" step="0.01" required />
          </div>
  
          <div class="form-group">
            <label for="height">Height (cm):</label>
            <input type="number" id="height" name="height" step="0.01" required />
          </div>
  
          <div class="form-group">
            <label for="gender">Gender:</label>
            <select id="gender" name="gender" required>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
          </div>
  
          <div class="form-group">
            <label for="activity-level">Activity Level:</label>
            <select id="activity-level" name="activity-level" required>
              <option value="sedentary">0-2</option>
              <option value="lightly active">2-4</option>
              <option value="moderately active">4-6</option>
              <option value="very active">6-8</option>
              <option value="extra active">8-10</option>
            </select>
          </div>
  
          <button type="submit" class="btn btn-primary">Calculate BMI and BMR</button>
        </form>
        <div id="personal-info-results">
          <!-- Results will be displayed here -->
        </div>
  
      </section>
  
  
  
  
  
  
      <section>
        <h2>Diet Plan Generator</h2>
        <form id="dietForm">
          <div class="form-group">
            <label for="state">State:</label>
            <select id="state" class="form-control" required>
              <option value="Andhra Pradesh">Andhra Pradesh</option>
              <option value="Arunachal Pradesh">Arunachal Pradesh</option>
              <option value="Assam">Assam</option>
              <option value="Bihar">Bihar</option>
              <option value="Chhattisgarh">Chhattisgarh</option>
              <option value="Goa">Goa</option>
              <option value="Gujarat">Gujarat</option>
              <option value="Haryana">Haryana</option>
              <option value="Himachal Pradesh">Himachal Pradesh</option>
              <option value="Jharkhand">Jharkhand</option>
              <option value="Karnataka">Karnataka</option>
              <option value="Kerala">Kerala</option>
              <option value="Madhya Pradesh">Madhya Pradesh</option>
              <option value="Maharashtra">Maharashtra</option>
              <option value="Manipur">Manipur</option>
              <option value="Meghalaya">Meghalaya</option>
              <option value="Mizoram">Mizoram</option>
              <option value="Nagaland">Nagaland</option>
              <option value="Odisha">Odisha</option>
              <option value="Punjab">Punjab</option>
              <option value="Rajasthan">Rajasthan</option>
              <option value="Sikkim">Sikkim</option>
              <option value="Tamil Nadu">Tamil Nadu</option>
              <option value="Telangana">Telangana</option>
              <option value="Tripura">Tripura</option>
              <option value="Uttar Pradesh">Uttar Pradesh</option>
              <option value="Uttarakhand">Uttarakhand</option>
              <option value="West Bengal">West Bengal</option>
            </select>
          </div>
  
          <div class="form-group">
            <label for="dietType">Diet Type:</label>
            <select id="dietType" class="form-control" required>
              <option value="0">Vegetarian</option>
              <option value="1">Non-Vegetarian</option>
            </select>
          </div>
  
          <div class="form-group">
            <label for="weightGoal">Weight Goal:</label>
            <select id="weightGoal" class="form-control" required>
              <option value="gain">Gain</option>
              <option value="lose">Lose</option>
              <option value="healthy">Healthy</option>
            </select>
          </div>
  
          <button type="submit" class="btn btn-primary">Get Diet Plan</button>
        </form>
        <div id="results"></div>
      </section>
    </div>
  
    <button class="back-to-top" onclick="scrollToTop()">
      <i class="fas fa-arrow-up"></i>
    </button>
  
  
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const personalInfoForm = document.getElementById("personal-info-form");
    const personalInfoResults = document.getElementById("personal-info-results");
    let isBmiBmrCalculated = false;  // Flag to check if BMI and BMR are calculated
  
    personalInfoForm.addEventListener("submit", function (event) {
      event.preventDefault();
  
      const age = parseInt(document.getElementById("age").value);
      const weight = parseFloat(document.getElementById("weight").value);
      const height = parseFloat(document.getElementById("height").value) / 100; // converting cm to meters
      const gender = document.getElementById("gender").value;
      const activityLevel = document.getElementById("activity-level").value;
  
      // Input validation
      if (isNaN(age) || age <= 0 || age > 120) {
  showModal("Please enter a valid age between 1 and 120.");
  return;
}

if (isNaN(weight) || weight <= 0 || weight > 500) {
  showModal("Please enter a valid weight between 1kg and 500kg.");
  return;
}

if (isNaN(height) || height <= 0 || height > 300) {
  showModal("Please enter a valid height between 1cm and 300cm.");
  return;
}

  
      // Calculate BMI
      const BMI = weight / (height * height);
  
      // Calculate BMR using Mifflin-St Jeor equation
      let BMR;
      if (gender === "male") {
        BMR = 10 * weight + 6.25 * height * 100 - 5 * age + 5;
      } else if (gender === "female") {
        BMR = 10 * weight + 6.25 * height * 100 - 5 * age - 161;
      } else {
        BMR = 10 * weight + 6.25 * height * 100 - 5 * age;
      }
  
      // Activity level adjustment factor
      let activityFactor;
      switch (activityLevel) {
        case "sedentary":
          activityFactor = 1.2;
          break;
        case "lightly active":
          activityFactor = 1.375;
          break;
        case "moderately active":
          activityFactor = 1.55;
          break;
        case "very active":
          activityFactor = 1.725;
          break;
        case "extra active":
          activityFactor = 1.9;
          break;
        default:
          alert("Please select a valid activity level.");
          return;
      }
  
      // Calculate maintenance calories
      const caloriesToMaintainWeight = BMR * activityFactor;
  
      // Macronutrient breakdown (example with general recommendations)
      const requiredCarbs = (caloriesToMaintainWeight * 0.45) / 4; // 45% carbs
      const requiredProtein = (caloriesToMaintainWeight * 0.30) / 4; // 30% protein
      const requiredFat = (caloriesToMaintainWeight * 0.25) / 9; // 25% fat
  
      // BMI Tags
      let BMITags;
      if (BMI < 18.5) {
        BMITags = "Underweight";
      } else if (BMI >= 18.5 && BMI < 24.9) {
        BMITags = "Normal weight";
      } else if (BMI >= 25 && BMI < 29.9) {
        BMITags = "Overweight";
      } else {
        BMITags = "Obese";
      }
  
      // Display results
      personalInfoResults.innerHTML = `
        <h2>Hey, we have calculated a few metrics to analyze your health!</h2>
        <p><span class="side-heading">Age:</span> ${age}</p>
        <p><span class="side-heading">Activity Level:</span> ${activityLevel}</p>
        <p><span class="side-heading">BMI:</span> ${BMI.toFixed(2)}</p>
        <p><span class="side-heading">BMR:</span> ${BMR.toFixed(2)} kcal/day</p>
        <p><span class="side-heading">BMI Tags:</span> ${BMITags}</p>
        <p><span class="side-heading">Calories to maintain weight:</span> ${caloriesToMaintainWeight.toFixed(2)} kcal/day</p>
        <p><span class="side-heading">Required daily intake of carbohydrates:</span> ${requiredCarbs.toFixed(2)} grams</p>
        <p><span class="side-heading">Required daily intake of protein:</span> ${requiredProtein.toFixed(2)} grams</p>
        <p><span class="side-heading">Required daily intake of fat:</span> ${requiredFat.toFixed(2)} grams</p>
      `;
  
      personalInfoResults.style.display = "block";
      isBmiBmrCalculated = true;  // Set flag to true when BMI and BMR are calculated
    });
  
    document.getElementById("dietForm").addEventListener("submit", async function (event) {
      event.preventDefault();
  
      if (!isBmiBmrCalculated) {
        alert("Please calculate BMI and BMR before getting the diet plan.");
        return;  // Prevent form submission if BMI and BMR are not calculated
      }
  
      const state = document.getElementById("state").value;
      const dietType = document.getElementById("dietType").value;
      const weightGoal = document.getElementById("weightGoal").value;
  
      if (!state || !dietType || !weightGoal) {
        alert("Please fill out all fields in the Diet Plan form.");
        return;
      }
  
      try {
        const response = await fetch(
          `http://127.0.0.1:8000/get_diet_plan/?state=${state}&diet_type=${dietType}&weight_goal=${weightGoal}`
        );
        if (!response.ok) {
          throw new Error("Network response was not ok");
        }
  
        const data = await response.json();
        document.getElementById("results").innerHTML = ""; // Clear previous results
        const mealSection = document.createElement("div");
        mealSection.className = "meal-section";
  
        // Add a heading for the selected meal
        const mealHeading = document.createElement("h2");
        mealHeading.textContent = "Diet Plan Suggestions";
        mealSection.appendChild(mealHeading);
  
        // Display suggestions
        const suggestions = data.suggestions;
        if (suggestions && suggestions.length > 0) {
          let tableHtml = `
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Food Name</th>
                  <th>Allergic Ingredients</th>
                  <th>Calories</th>
                  <th>Proteins</th>
                  <th>Fats</th>
                  <th>Carbohydrates</th>
                  <th>Sodium</th>
                  <th>Vitamin Content</th>
                </tr>
              </thead>
              <tbody>`;
  
          suggestions.forEach((item) => {
            tableHtml += `
              <tr>
                <td>${item['Food Name']}</td>
                <td>${item['Allergic Ingredients'] || "None"}</td>
                <td>${item['Total Calories']}</td>
                <td>${item['Total Protein']}</td>
                <td>${item['Total Fats']}</td>
                <td>${item['Total Carbs']}</td>
                <td>${item['Total Sodium']}</td>
                <td>${item['Vitamin Content']}</td>
              </tr>`;
          });
  
          tableHtml += "</tbody></table>";
          mealSection.innerHTML += tableHtml;
        } else {
          mealSection.innerHTML += "<p>No suggestions available</p>";
        }
  
        document.getElementById("results").appendChild(mealSection);
        document.getElementById("results").style.display = "block";
      } catch (error) {
        console.error("Error fetching diet plan:", error);
        document.getElementById("results").innerHTML = "<p>Failed to load diet plan.</p>";
      }
    });
  });
  // JavaScript to show modal
  function showModal(message, type = "error") {
      const modal = document.getElementById('errorModal');
      const modalMessage = document.getElementById('modalMessage');
      const warningLabel = document.getElementById('warningLabel');

      // Set message content and style based on type
      modalMessage.textContent = message;
      
      if (type === "warning") {
        warningLabel.style.display = "block";  // Show warning label
        modalMessage.classList.add("warning-message");
        modalMessage.classList.remove("error-message");
      } else {
        warningLabel.style.display = "none";  // Hide warning label
        modalMessage.classList.add("error-message");
        modalMessage.classList.remove("warning-message");
      }

      modal.style.display = "block";
    }

    // Close the modal when the close button is clicked
    document.querySelector('.close-btn').addEventListener('click', function () {
      const modal = document.getElementById('errorModal');
      modal.style.display = "none";
    });

    // Close the modal when the outside of the modal is clicked
    window.addEventListener('click', function (event) {
      const modal = document.getElementById('errorModal');
      if (event.target === modal) {
        modal.style.display = "none";
      }
    });

    // Example function that triggers the warning modal
    function showWarningMessage() {
      showModal("This is a warning message!", "warning");
    }

    // Example function that triggers the error modal
    function showErrorMessage() {
      showModal("This is an error message!");
    }

  
   

</script>

</body>
</html>